}
#funkcja do porównania modeli
anova_nadmodel <- function(nadmodele, model_bazowy) {
p <- list()
for (i in seq_along(nadmodele)) {
x <- anova(model_bazowy, nadmodele[[i]], test = "Chisq")
p[[i]] <- c(
Deviance = round(x$Deviance[2], 2),
Df = x$Df[2],
p_value = signif(1 - pchisq(x$Deviance[2], x$Df[2]), 3)
)
}
names(p) <- names(nadmodele)
do.call(rbind, p)
}
dane <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(dane) <- c('DZIAŁ','STAZ','CZY_KIER', 'PYT_1', 'PYT_2', 'PYT_3', 'PLEC', 'WIEK')
library(dplyr)
dane_zliczone <- dane %>%
group_by(CZY_KIER, PYT_2, STAZ) %>%
summarise(Freq = n(), .groups = "drop")
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = dane_zliczone, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = dane_zliczone, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = dane_zliczone, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = dane_zliczone, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = dane_zliczone, family = poisson)
)
#wyciagamy ze slownika
model_12 <- models$model_12
model_13 <- models$model_13
model_23 <- models$model_23
model_12_13 <- models$model_12_13
model_12_23 <- models$model_12_23
model_13_23 <- models$model_13_23
model_12_13_23 <- models$model_12_13_23
model_123 <- models$model_123
models_a <- list(
"[12 13]" = model_12_13,
"[13 23]" = model_13_23,
"[123]" = model_123,
"[12 13 23]" = model_12_13_23
)
results_a <- anova_nadmodel(models_a, model_1_2_3)
print(results_a)
models_b <- list(
"[12 3]" = model_12_3 <- glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
"[1 23]" = model_1_23 <- glm(Freq ~ CZY_KIER + PYT_2 * STAZ, data = dane_zliczone, family = poisson),
"[13 2]" = model_13_2 <- glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
"[123]" = model_123
)
results_b <- anova_nadmodel(models_b, model_123)
print(results_b)
models_b <- list(
"[12 3]" = model_12_3 <- glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
"[1 23]" = model_1_23 <- glm(Freq ~ CZY_KIER + PYT_2 * STAZ, data = dane_zliczone, family = poisson),
"[13 2]" = model_13_2 <- glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
"[123]" = model_123
)
results_b <- anova_nadmodel(models_b, model_2_13)
models_b <- list(
"[12 3]" = model_12_3 <- glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
"[1 23]" = model_1_23 <- glm(Freq ~ CZY_KIER + PYT_2 * STAZ, data = dane_zliczone, family = poisson),
"[13 2]" = model_13_2 <- glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
"[123]" = model_123
)
model_2_13 <- glm(Freq ~ PYT_2 + CZY_KIER * STAZ, data = dane_zliczone, family = poisson)
results_b <- anova_nadmodel(models_b, model_2_13)
print(results_b)
models_b <- list(
"[12 13]" = model_12_13,
"[13 23]" = model_1_23,
"[12 13 23]" = model_12_13_23 <- glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
"[123]" = model_123
)
model_2_13 <- glm(Freq ~ PYT_2 + CZY_KIER * STAZ, data = dane_zliczone, family = poisson)
results_b <- anova_nadmodel(models_b, model_2_13)
print(results_b)
dane <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(dane) <- c('DZIAŁ','STAZ','CZY_KIER', 'PYT_1', 'PYT_2', 'PYT_3', 'PLEC', 'WIEK')
library(dplyr)
dane_zliczone <- dane %>%
group_by(CZY_KIER, PYT_2, STAZ) %>%
summarise(Freq = n(), .groups = "drop")
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = dane_zliczone, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = dane_zliczone, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = dane_zliczone, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = dane_zliczone, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = dane_zliczone, family = poisson)
)
#wyciagamy ze slownika
model_12 <- models$model_12
model_13 <- models$model_13
model_23 <- models$model_23
model_12_13 <- models$model_12_13
model_12_23 <- models$model_12_23
model_13_23 <- models$model_13_23
model_12_13_23 <- models$model_12_13_23
model_123 <- models$model_123
models_b <- list(
"[12 13]" = model_12_13,
"[13 23]" = model_1_23,
"[12 13 23]" = model_12_13_23,
"[123]" = model_123
)
model_2_13 <- glm(Freq ~ PYT_2 + CZY_KIER * STAZ, data = dane_zliczone, family = poisson)
results_b <- anova_nadmodel(models_b, model_2_13)
print(results_b)
models_c <- list(
"[13 23]" = model_13_23,
"[123]" = model_123
)
results_c <- anova_nadmodel(model_13_23, model_123)
print(results_c)
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models_a <- list(
"[12 13]" = model_12_13,
"[13 23]" = model_13_23,
"[123]" = model_123,
"[12 13 23]" = model_12_13_23
)
results_a <- anova_nadmodel(models_a, model_1_2_3)
print(results_a)
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAŻ, data = tab_8, family = poisson)
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = dane_zliczone, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = dane_zliczone, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = dane_zliczone, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = dane_zliczone, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = dane_zliczone, family = poisson)
)
anova_nadmodel(model_1_2_3, models)
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = dane_zliczone, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = dane_zliczone, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = dane_zliczone, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = dane_zliczone, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = dane_zliczone, family = poisson)
)
anova_nadmodel(model_1_2_3, models)
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAŻ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(CZY_KIER, PYT_2, STAŻ))
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAŻ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(CZY_KIER ~ PYT_2 + STAŻ, data = df))
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = dane_zliczone, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = dane_zliczone, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = dane_zliczone, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = dane_zliczone, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = dane_zliczone, family = poisson)
)
anova_nadmodel(model_1_2_3, models)
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAŻ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(dane$CZY_KIER, dane$PYT_2, dane$STAŻ))
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = dane_zliczone, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = dane_zliczone, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = dane_zliczone, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = dane_zliczone, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = dane_zliczone, family = poisson)
)
anova_nadmodel(model_1_2_3, models)
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = dane_zliczone, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = dane_zliczone, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = dane_zliczone, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = dane_zliczone, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = dane_zliczone, family = poisson)
)
anova_nadmodel(model_1_2_3, models)
model_13 = glm(Freq ~ CZY_KIER * STAŻ + PYT_2, family = poisson, data = tab_8)
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAŻ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(dane$CZY_KIER, dane$PYT_2, dane$STAŻ))
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAŻ, data = tab_8, family = poisson)
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAŻ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(dane$CZY_KIER, dane$PYT_2, dane$STAŻ))
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAZ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(dane$CZY_KIER, dane$PYT_2, dane$STAZ))
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = tab_8, family = poisson)
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAZ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(dane$CZY_KIER, dane$PYT_2, dane$STAZ))
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
colnames(tab_8)
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = tab_8, family = poisson)
dane <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(dane) <- c('DZIAŁ','STAZ','CZY_KIER', 'PYT_1', 'PYT_2', 'PYT_3', 'PLEC', 'WIEK')
library(dplyr)
dane_zliczone <- dane %>%
group_by(CZY_KIER, PYT_2, STAZ) %>%
summarise(Freq = n(), .groups = "drop")
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = dane_zliczone, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = dane_zliczone, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = dane_zliczone, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = dane_zliczone, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = dane_zliczone, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = dane_zliczone, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = dane_zliczone, family = poisson)
)
#wyciagamy ze slownika
model_12 <- models$model_12
model_13 <- models$model_13
model_23 <- models$model_23
model_12_13 <- models$model_12_13
model_12_23 <- models$model_12_23
model_13_23 <- models$model_13_23
model_12_13_23 <- models$model_12_13_23
model_123 <- models$model_123
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = dane_zliczone, family = poisson)
models_a <- list(
"[12 13]" = model_12_13,
"[13 23]" = model_13_23,
"[123]" = model_123,
"[12 13 23]" = model_12_13_23
)
results_a <- anova_nadmodel(models_a, model_1_2_3)
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAZ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(dane$CZY_KIER, dane$PYT_2, dane$STAZ))
colnames(tab_8) <- c("CZY_KIER", "PYT_2", "STAŻ", "Freq")
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
colnames(tab_8)
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAZ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(dane$CZY_KIER, dane$PYT_2, dane$STAZ))
colnames(tab_8) <- c("CZY_KIER", "PYT_2", "STAZ", "Freq")
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
colnames(tab_8)
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = tab_8, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = tab_8, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = tab_8, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = tab_8, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = tab_8, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = tab_8, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = tab_8, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = tab_8, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = tab_8, family = poisson)
)
anova_nadmodel(model_1_2_3, models)
model_13 = glm(Freq ~ CZY_KIER * STAŻ + PYT_2, family = poisson, data = tab_8)
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, family = poisson, data = tab_8)
models <- list(
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ, data = tab_8, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ, data = tab_8, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2*STAZ + CZY_KIER*PYT_2, family = poisson, data = tab_8),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = tab_8, family = poisson)
)
anova_nadmodel(model_13, models)
model_13_23 = glm(Freq ~ CZY_KIER * STAŻ + PYT_2 * STAŻ, data = tab_8, family = poisson)
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ, data = tab_8, family = poisson)
models <- list(
model_12_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2*STAZ + CZY_KIER*PYT_2, family = poisson, data = tab_8),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = tab_8, family = poisson)
)
anova_nadmodel(model_13_23, models)
df <- read.csv("ankieta.csv", sep = ";", fileEncoding = "Latin2")
colnames(df) <- c('DZIAŁ','STAZ','CZY_KIER', 'PYT_1',
'PYT_2', 'PYT_3', 'PŁEĆ', 'WIEK')
dane <- df
char_col <- sapply(df, is.character)
df[ ,char_col] <- lapply(df[ ,char_col], as.factor)
sum = sum(is.na(df))
if (sum != 0){na_coords <- which(is.na(df), arr.ind = TRUE)
apply(na_coords, 1, function(x) paste0("(", x[1], ", ", x[2], ")"))}
roundandformat <- function(x, d) {
formatC(x, format = "f", digits = d)
}
tab_8 <- data.frame(ftable(dane$CZY_KIER, dane$PYT_2, dane$STAZ))
colnames(tab_8) <- c("CZY_KIER", "PYT_2", "STAZ", "Freq")
anova_nadmodel <- function(mi_0, mi_1s) {
p <- list()
for (i in seq_along(mi_1s)) {
x <- anova(mi_0, mi_1s[[i]], test = "Chisq")
p[[i]] <- 1 - pchisq(x$Deviance[2], x$Df[2])
}
names(p) <- names(mi_1s)
return(p)
}
colnames(tab_8)
model_1_2_3 = glm(Freq ~ CZY_KIER + PYT_2 + STAZ, data = tab_8, family = poisson)
models <- list(
model_12 = glm(Freq ~ CZY_KIER * PYT_2 + STAZ, data = tab_8, family = poisson),
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, data = tab_8, family = poisson),
model_23 = glm(Freq ~ PYT_2 * STAZ + CZY_KIER, data = tab_8, family = poisson),
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 + STAZ, data = tab_8, family = poisson),
model_12_23 = glm(Freq ~ CZY_KIER * PYT_2 + PYT_2 * STAZ + CZY_KIER + STAZ, data = tab_8, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ + CZY_KIER + PYT_2, data = tab_8, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ + PYT_2 * STAZ , data = tab_8, family = poisson),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = tab_8, family = poisson)
)
anova_nadmodel(model_1_2_3, models)
model_13 = glm(Freq ~ CZY_KIER * STAZ + PYT_2, family = poisson, data = tab_8)
models <- list(
model_12_13 = glm(Freq ~ CZY_KIER * PYT_2 + CZY_KIER * STAZ, data = tab_8, family = poisson),
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ, data = tab_8, family = poisson),
model_12_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2*STAZ + CZY_KIER*PYT_2, family = poisson, data = tab_8),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = tab_8, family = poisson)
)
anova_nadmodel(model_13, models)
model_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2 * STAZ, data = tab_8, family = poisson)
models <- list(
model_12_13_23 = glm(Freq ~ CZY_KIER * STAZ + PYT_2*STAZ + CZY_KIER*PYT_2, family = poisson, data = tab_8),
model_123 = glm(Freq ~ CZY_KIER * PYT_2 * STAZ, data = tab_8, family = poisson)
)
anova_nadmodel(model_13_23, models)
